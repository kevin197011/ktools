#!/usr/bin/env ruby

require 'net/http'
require 'json'


=begin
ip-api check ip info command
curl http://ip-api.com/json/24.48.0.1
=end

if ARGV.length != 1 || ARGV[0].match(/-h|--help/)
  puts <<~EOH
    Usage:
        ip-api xxx.xxx.xxx.xxx(IP address)
  EOH
  exit
end

if !ARGV[0].match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)
  puts "Error: IP format error!"
  exit
end

uri = URI("http://ip-api.com/json/#{ARGV[0]}")
context = Net::HTTP.get(uri)

puts JSON.pretty_generate(JSON.parse(context))

